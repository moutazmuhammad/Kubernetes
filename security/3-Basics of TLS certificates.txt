- تُستخدم الشهادة لضمان الثقة بين طرفين أثناء المعاملة.
	- على سبيل المثال ، عندما يحاول المستخدم الوصول إلى خادم الويب. تضمن شهادات TLS أن الاتصال بين المستخدم والخادم مشفر .


** بدون اتصال آمن. 
- إذا كان على المستخدم الوصول إلى تطبيق الخدمات المصرفية عبر الإنترنت الخاص به ، فسيتم إرسال بيانات الاعتماد التي يكتبها بتنسيق نص عادي.
- يمكن لحركة مرور شبكة المتسللين المتطفلة استرداد بيانات الاعتماد بسهولة واستخدامها لاختراق الحساب المصرفي للمستخدم.


- لذلك يجب عليك تشفير البيانات التي يتم نقلها باستخدام مفاتيح التشفير.
--------------------------------------------------------------------------------------------------------------------------------------------

- يتم تشفير البيانات باستخدام مفتاح ، وهو في الأساس مجموعة من الأرقام العشوائية والحروف الهجائية.
- أنت تضيف الرقم العشوائي إلى بياناتك وتقوم بتشفيره بتنسيق لا يمكن التعرف عليه.
- ثم يتم إرسال البيانات إلى الخادم.
- يحصل المتسلل الذي يستنشق الشبكة على البيانات ولكن لا يمكنه فعل أي شيء بها.
- ومع ذلك ، فإن الأمر نفسه ينطبق على الخادم الذي يتلقى البيانات. لا يمكن فك تشفير البيانات بدون المفتاح.
- لذلك يجب أيضًا إرسال نسخة من المفتاح إلى الخادم حتى يتمكن الخادم من فك تشفير الرسالة وقراءتها.

- نظرًا لأن المفتاح يتم إرساله أيضًا عبر نفس الشبكة ، يمكن للمهاجم شم ذلك أيضًا وفك تشفير البيانات به.

==>> يُعرف هذا باسم التشفير المتماثل. symmetric encryption

- إنها طريقة آمنة للتشفير.

- ولكن نظرًا لأنه يستخدم نفس المفتاح لتشفير البيانات وفك تشفيرها ، ولأن المفتاح يجب أن يتم تبادله بين المرسل والمستقبل ، فهناك خطر أن يتمكن أحد المتطفلين من الوصول إلى المفتاح وفك تشفير البيانات.

--------------------------------------------------------------------------------------------------------------------------------------------


- وهنا يأتي دور التشفير غير المتماثل. asymmetric encryption

- بدلاً من استخدام مفتاح واحد لتشفير البيانات وفك تشفيرها ، يستخدم التشفير غير المتماثل زوجًا من المفاتيح (ومفتاحًا خاصًا ومفتاحًا عامًا)
- مفتاح ، وهو معي فقط. لذلك فهو خاص ، قفل يمكن لأي شخص الوصول إليه لذا فهي عامة.

- إذا قمت بتشفير البيانات أو قفلها باستخدام القفل الخاص بك ، فلا يمكنك فتحها إلا باستخدام المفتاح المرتبط.
- لذلك يجب أن يكون مفتاحك دائمًا آمنًا معك وألا يتم مشاركته مع أي شخص آخر.

نستخدم أمر openssl لإنشاء زوج مفاتيح خاص وعام.
openssl genrsa --out my-bank.key 1024                   --> private key
opemssl rsa in my-bank.key -pubout > mybank.pem         --> public key 


- كانت المشكلة التي واجهناها سابقًا مع التشفير المتماثل هي أن المفتاح المستخدم لتشفير البيانات يجب أن يتم إرساله إلى الخادم عبر الشبكة جنبًا إلى جنب مع البيانات المشفرة.
- وبالتالي هناك خطر أن يحصل المتسلل على مفتاح فك تشفير البيانات.

- لنقل المفتاح المتماثل بأمان من العميل إلى الخادم. نستخدم التشفير غير المتماثل لذلك نقوم بإنشاء زوج مفاتيح عام وخاص على الخادم.

---------------------------------------------------------------------------------------------------------------------------------------------

- عندما يصل المستخدم لأول مرة إلى خادم الويب باستخدام https ، يحصل على المفتاح العام من الخادم.
- نظرًا لأن المخترق يستنشق كل حركة المرور المفترضة ، فإنه يحصل أيضًا على نسخة من المفتاح العام.

-يقوم متصفح المستخدم بعد ذلك بتشفير المفتاح المتماثل باستخدام المفتاح العام الذي يوفره الخادم.

- ثم يرسل المستخدم هذا إلى الخادم. يحصل المخترق أيضًا على نسخة.

- يستخدم الخادم المفتاح الخاص لفك تشفير الرسالة واسترداد المفتاح المتماثل منها.

- ومع ذلك ، لا يمتلك المخترق المفتاح الخاص لفك تشفير واسترداد المفتاح المتماثل من الرسالة التي تلقاها.

- المتسلل لديه فقط المفتاح العام الذي يمكنه من خلاله فقط قفل الرسالة أو تشفيرها وعدم فك تشفير الرسالة.

- أصبح المفتاح المتماثل متوفرًا بأمان فقط للمستخدم والخادم.

- يمكنهم الآن استخدام المفتاح المتماثل لتشفير البيانات وإرسالها إلى بعضهم البعض.

- يمكن لجهاز الاستقبال استخدام نفس المفتاح المتماثل لفك تشفير البيانات واسترداد المعلومات.

- يُترك المخترق مع الرسائل المشفرة والمفاتيح العامة التي لا يمكنه فك تشفير أي بيانات بها.


---------------------------------------------------------------------------------------------------------------------------------------------

- يبحث المخترق الآن عن طرق جديدة لاختراق حسابك.

- ولذا فهو يدرك أن الطريقة الوحيدة التي يمكنه من خلالها الحصول على أوراق اعتمادك هي جعلك تكتبها في النموذج الذي يقدمه.

- لذلك قام بإنشاء موقع ويب يشبه تمامًا موقع الويب الخاص بالمصرف الذي تتعامل معه. التصميم هو نفسه ، والرسومات هي نفسها. الموقع هو نسخة طبق الأصل من موقع البنك الفعلي.

- لذلك قام بإنشاء مجموعته الخاصة من أزواج المفاتيح العامة والخاصة وتكوينها على خادم الويب الخاص به. وأخيرًا ، تمكن بطريقة ما من تعديل بيئتك أو شبكتك لتوجيه طلبك ، والانتقال إلى موقع البنك الذي تتعامل معه ، إلى خوادمه.

- عندما تفتح متصفحك وتكتب عنوان موقع الويب. ترى صفحة مألوفة للغاية ، نفس صفحة تسجيل الدخول للبنك الذي تتعامل معه التي اعتدت رؤيتها. لذا عليك المضي قدمًا وكتابة اسم المستخدم وكلمة المرور.

- لقد كنت تتواصل بشكل آمن وبطريقة مشفرة ، ولكن مع خادم المتسلل ، بمجرد إرسال بيانات الاعتماد الخاصة.
--------------------------------------------------------------------------------------------------------------------------------------

- ماذا لو كان بإمكانك إلقاء نظرة على المفتاح الذي تلقيته من الخادم وتقول ما إذا كان مفتاحًا شرعيًا.

- عندما يرسل الخادم المفتاح ، فإنه لا يرسل المفتاح بمفرده. يرسل شهادة بها المفتاح.


- إذا ألقيت نظرة فاحصة على الشهادة ، فسترى أنها تشبه الشهادة الفعلية. ولكن في التنسيق الرقمي ، يحتوي على معلومات حول من يتم إصدار الشهادة للمفتاح العام لذلك الخادم.

- فكيف تنظر إلى الشهادة وتتحقق مما إذا كانت شرعية؟ هذا هو المكان الذي يلعب فيه أهم جزء من الشهادة. من وقع وأصدر الشهادة؟

- إذا قمت بإنشاء شهادة ، فسيتعين عليك التوقيع عليها بنفسك. يُعرف ذلك بالشهادة الموقعة ذاتيًا.

- أي شخص ينظر إلى الشهادة التي أنشأتها سيعرف على الفور أنها ليست شهادة آمنة لأنك وقعت عليها.

- إذا نظرت عن كثب إلى الشهادة التي تلقيتها من المخترق ، فستلاحظ أنها كانت شهادة مزيفة تم توقيعها من قبل المخترق نفسه.

- في الواقع ، متصفحك يقوم بذلك نيابة عنك.جميع متصفحات الويب مدمجة بآلية التحقق من صحة الشهادة حيث يتحقق المتصفح من الشهادة. إذا حددت أنها شهادة مزيفة ، فإنها تحذرك بالفعل.

-----------------------------------------------------------------------------------------------------------------------------------------

- إذن ، كيف يمكنك إنشاء شهادة شرعية لخوادم الويب التي تثق بها متصفحات الويب؟ كيف يتم التوقيع على شهاداتك؟ من قبل شخص له سلطة.

- هذا هو المكان الذي يأتي فيه مراجع التصديق أو CA

- إنها مؤسسات معروفة جيدًا يمكنها التوقيع والتحقق من صحة شهاداتك نيابة عنك. ومن أشهرها Symantec و Desert و Comodo و Global Sign وما إلى ذلك.

- الطريقة التي يعمل بها هذا هي إنشاء شهادة أو طلب توقيع أو CSR باستخدام المفتاح الذي أنشأته مسبقًا واسم المجال لموقع الويب الخاص بك.

- يمكنك القيام بذلك مرة أخرى باستخدام أمر openssl.
openssl req -new my-bank.key --out my-bank csr -subj "/C=US/ST/CA/O/MyOrg,Inc./CN=my-bank.com"

- تتحقق السلطات من التفاصيل الخاصة بك وبمجرد أن يتم تسجيل المغادرة ، يقومون بتوقيع الشهادة وإرسالها إليك مرة.

- إذا حاول أحد المتطفلين توقيع شهادته بنفس الطريقة ، فسيفشل أثناء مرحلة التحقق من الصحة وسيتم رفض.
-------------------------------------------------------------------------------------------------------------------------------------------

- هناك ثلاثة أنواع من شهادات خادم الشهادات :
	1- التي تم تكوينها على تلك الخوادم (server crt)
	2- تم تكوينها على خوادم CA (root crt)
	3- التي تم تكوينها على العميل. (client crt)

- وملاحظة سريعة حول التسمية:
	certificate(public key)				private certificate
		*.crt	*.pem					*.key   *-key.pem
		server.crt					server.key
		server.pem					server-key.pem
		client.crt					client.key
		client.pem					client-key.pem
		






























































